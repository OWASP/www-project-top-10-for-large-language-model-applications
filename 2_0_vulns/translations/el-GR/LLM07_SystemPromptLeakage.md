## LLM07:2025 Διαρροή Προτροπών   Συστήματος (System Prompt Leakage)

### Περιγραφή

Η ευπάθεια διαρροής προτροπών του συστήματος στα LLM αναφέρεται στον κίνδυνο οι προτροπές ή οι οδηγίες του συστήματος που χρησιμοποιούνται για την καθοδήγηση της συμπεριφοράς του μοντέλου να περιέχουν επίσης ευαίσθητες πληροφορίες που δεν προορίζονταν να αποκαλυφθούν. Οι προτροπές του συστήματος έχουν σχεδιαστεί για να καθοδηγούν την έξοδο του μοντέλου με βάση τις απαιτήσεις της εφαρμογής, αλλά μπορεί να περιέχουν εκ παραδρομής απόρρητες πληροφορίες. Όταν ανακαλυφθούν, οι πληροφορίες αυτές μπορούν να χρησιμοποιηθούν για τη διευκόλυνση άλλων επιθέσεων.

Είναι σημαντικό να γίνει αντιληπτό ότι η προτροπή του συστήματος δεν πρέπει να θεωρείται απόρρητη, ούτε να χρησιμοποιείται ως έλεγχος ασφαλείας. Κατά συνέπεια, ευαίσθητα δεδομένα όπως διαπιστευτήρια, συμβολοσειρές σύνδεσης κ.λπ. δεν θα πρέπει να περιέχονται στη γλώσσα της προτροπής συστήματος.

Ομοίως, εάν μια προτροπή συστήματος περιέχει πληροφορίες που περιγράφουν διαφορετικούς ρόλους και δικαιώματα ή ευαίσθητα δεδομένα όπως συμβολοσειρές σύνδεσης ή κωδικούς πρόσβασης, ενώ η αποκάλυψη αυτών των πληροφοριών μπορεί να είναι χρήσιμη, ο θεμελιώδης κίνδυνος ασφάλειας δεν είναι ότι αυτά έχουν αποκαλυφθεί, αλλά ότι η εφαρμογή επιτρέπει την παράκαμψη ισχυρών ελέγχων διαχείρισης συνόδου και εξουσιοδότησης αναθέτοντάς τους στο LLM και ότι ευαίσθητα δεδομένα αποθηκεύονται σε μέρος που δεν θα έπρεπε να βρίσκονται.

Εν συντομία: η αποκάλυψη της ίδιας της προτροπής του συστήματος δεν αποτελεί τον πραγματικό κίνδυνο - ο κίνδυνος ασφάλειας έγκειται στα υποκείμενα στοιχεία, είτε πρόκειται για αποκάλυψη ευαίσθητων πληροφοριών, είτε για παράκαμψη των προστατευτικών δικλείδων του συστήματος, είτε για πλημμελή διαχωρισμό των προνομίων κ.λπ. Ακόμη και αν δεν αποκαλυφθεί η ακριβής διατύπωση, οι επιτιθέμενοι που αλληλεπιδρούν με το σύστημα θα είναι σχεδόν σίγουρα σε θέση να προσδιορίσουν πολλές από τις προστατευτικές δικλείδες και τους περιορισμούς μορφοποίησης που υπάρχουν στη γλώσσα της προτροπής συστήματος κατά τη διάρκεια της χρήσης της εφαρμογής, της αποστολής λεκτικών στο μοντέλο και της παρατήρησης των αποτελεσμάτων.

### Συνήθη Παραδείγματα Κινδύνου

#### 1. Αποκάλυψη Ευαίσθητων Λειτουργιών

  Η προτροπή συστήματος της εφαρμογής μπορεί να αποκαλύψει ευαίσθητες πληροφορίες ή λειτουργίες που προορίζονται να παραμείνουν εμπιστευτικές, όπως απόρρητα στοιχεία αρχιτεκτονικής του συστήματος, κλειδιά API, διαπιστευτήρια βάσης δεδομένων ή διακριτικά χρήστη.  Αυτά μπορούν να εξαχθούν ή να χρησιμοποιηθούν από επιτιθέμενους για να αποκτήσουν μη εξουσιοδοτημένη πρόσβαση στην εφαρμογή. Για παράδειγμα, μια προτροπή συστήματος που περιέχει τον τύπο της βάσης δεδομένων που χρησιμοποιείται για ένα εργαλείο θα μπορούσε να επιτρέψει στον επιτιθέμενο να το στοχεύσει για επιθέσεις SQL injection.

#### 2. Αποκάλυψη Εσωτερικών Κανόνων

  Η προτροπή συστήματος της εφαρμογής αποκαλύπτει πληροφορίες σχετικά με τις εσωτερικές διαδικασίες λήψης αποφάσεων που πρέπει να παραμείνουν εμπιστευτικές. Αυτές οι πληροφορίες επιτρέπουν στους επιτιθέμενους να αποκτήσουν γνώσεις σχετικά με τον τρόπο λειτουργίας της εφαρμογής, οι οποίες θα μπορούσαν να επιτρέψουν στους επιτιθέμενους να εκμεταλλευτούν αδυναμίες ή να παρακάμψουν ελέγχους της εφαρμογής. Για παράδειγμα - Υπάρχει μια τραπεζική εφαρμογή που διαθέτει ένα chatbot και η προτροπή συστήματος μπορεί να αποκαλύψει πληροφορίες όπως
    >"Το όριο συναλλαγών έχει οριστεί σε $5000 ανά ημέρα για έναν χρήστη. Το συνολικό ποσό δανείου για έναν χρήστη είναι 10.000 δολάρια».
  Αυτές οι πληροφορίες επιτρέπουν στους επιτιθέμενους να παρακάμψουν τους ελέγχους ασφαλείας της εφαρμογής, όπως να πραγματοποιούν συναλλαγές μεγαλύτερες από το καθορισμένο όριο ή να παρακάμπτουν το συνολικό ποσό δανείου.

#### 3. Αποκάλυψη Κριτηρίων Φιλτραρίσματος

  Μια προτροπή του συστήματος μπορεί να ζητήσει από το μοντέλο να φιλτράρει ή να απορρίψει ευαίσθητο περιεχόμενο. Για παράδειγμα, ένα μοντέλο μπορεί να έχει μια προτροπή συστήματος όπως,
    >“Εάν ένας χρήστης ζητήσει πληροφορίες σχετικά με έναν άλλο χρήστη, απαντήστε πάντα με τη φράση «Λυπάμαι, δεν μπορώ να βοηθήσω σε αυτό το αίτημα».’”.

#### 4. Αποκάλυψη Δικαιωμάτων και Ρόλων Χρηστών

  Η προτροπή του συστήματος θα μπορούσε να αποκαλύψει τις εσωτερικές δομές ρόλων ή τα επίπεδα δικαιωμάτων της εφαρμογής. Για παράδειγμα, μια προτροπή συστήματος μπορεί να αποκαλύψει,
    >“Ο ρόλος χρήστη Admin παρέχει πλήρη πρόσβαση στην τροποποίηση των εγγραφών χρηστών.”
  Εάν οι επιτιθέμενοι μάθουν για αυτά τα δικαιώματα βάσει ρόλων, θα μπορούσαν να αναζητήσουν μια επίθεση κλιμάκωσης προνομίων.

### Στρατηγικές Πρόληψης και Αντιμετώπισης

#### 1. Διαχωρισμός των ευαίσθητων δεδομένων από τις προτροπές συστήματος

  Αποφύγετε την ενσωμάτωση ευαίσθητων πληροφοριών (π.χ. κλειδιά API, κλειδιά εξουσιοδότησης, ονόματα βάσεων δεδομένων, ρόλους χρηστών, δομή δικαιωμάτων της εφαρμογής) απευθείας στις προτροπές του συστήματος. Αντ' αυτού, εξωτερικεύστε αυτές τις πληροφορίες στα συστήματα στα οποία δεν έχει άμεση πρόσβαση το μοντέλο.

#### 2. Αποφυγή της εξάρτησης από τις προτροπές του συστήματος για αυστηρό έλεγχο συμπεριφοράς

  Δεδομένου ότι τα LLM είναι ευάλωτα σε άλλες επιθέσεις, όπως οι εγχύσεις προτροπών που μπορούν να τροποποιήσουν την προτροπή του συστήματος, συνιστάται να αποφεύγεται η χρήση προτροπών συστήματος για τον έλεγχο της συμπεριφοράς του μοντέλου, όπου αυτό είναι δυνατόν.  Αντ' αυτού, βασιστείτε σε συστήματα εκτός του LLM για να διασφαλίσετε αυτή τη συμπεριφορά.  Για παράδειγμα, η ανίχνευση και η πρόληψη επιβλαβούς περιεχομένου θα πρέπει να γίνεται σε εξωτερικά συστήματα.

#### 3. Εφαρμογή προστατευτικών δικλείδων

  Εφαρμόστε ένα σύστημα προστατευτικών δικλείδων εκτός του ίδιου του LLM.  Παρόλο που η εκπαίδευση συγκεκριμένης συμπεριφοράς σε ένα μοντέλο μπορεί να είναι αποτελεσματική, όπως η εκπαίδευσή του να μην αποκαλύπτει την προτροπή του συστήματος, δεν αποτελεί εγγύηση ότι το μοντέλο θα τηρεί πάντοτε αυτή τη συμπεριφορά.  Ένα ανεξάρτητο σύστημα που μπορεί να επιθεωρήσει την έξοδο για να καθορίσει αν το μοντέλο συμμορφώνεται με τις προσδοκίες είναι προτιμότερο από τις οδηγίες προτροπής συστήματος.

#### 4. Διασφάλιση ότι οι έλεγχοι ασφαλείας επιβάλλονται ανεξάρτητα από το LLM

  Οι κρίσιμοι έλεγχοι, όπως ο διαχωρισμός προνομίων, οι έλεγχοι ορίων εξουσιοδότησης και άλλα παρόμοια, δεν πρέπει να ανατίθενται στο LLM, είτε μέσω της προτροπής συστήματος είτε με άλλο τρόπο. Αυτοί οι έλεγχοι πρέπει να πραγματοποιούνται με ντετερμινιστικό, ελέγξιμο τρόπο και τα LLM δεν ευνοούν (επί του παρόντος) κάτι τέτοιο. Σε περιπτώσεις όπου ένας πράκτορας εκτελεί καθήκοντα, εάν τα καθήκοντα αυτά απαιτούν διαφορετικά επίπεδα πρόσβασης, τότε θα πρέπει να χρησιμοποιούνται πολλαπλοί πράκτορες, καθένας από τους οποίους θα έχει ρυθμιστεί με τα λιγότερα προνόμια που απαιτούνται για την εκτέλεση των επιθυμητών εργασιών.

### Παραδείγματα Σεναρίων Επίθεσης

#### Σενάριο #1

   Ένα LLM διαθέτει μια προτροπή συστήματος που περιέχει ένα σύνολο διαπιστευτηρίων που χρησιμοποιούνται για ένα εργαλείο στο οποίο του έχει δοθεί πρόσβαση.  Η προτροπή συστήματος αποκαλύπτεται σε έναν εισβολέα, ο οποίος στη συνέχεια μπορεί να χρησιμοποιήσει αυτά τα διαπιστευτήρια για άλλους σκοπούς.

#### Σενάριο #2

  Ένα LLM διαθέτει μια προτροπή συστήματος που απαγορεύει τη δημιουργία επιθετικού περιεχομένου, εξωτερικών συνδέσμων και την εκτέλεση κώδικα. Ένας εισβολέας εξάγει αυτή την προτροπή συστήματος και στη συνέχεια χρησιμοποιεί μια επίθεση έγχυσης προτροπής για να παρακάμψει αυτές τις οδηγίες, διευκολύνοντας μια επίθεση απομακρυσμένης εκτέλεσης κώδικα.

### Σύνδεσμοι Αναφοράς

1. [SYSTEM PROMPT LEAK](https://x.com/elder_plinius/status/1801393358964994062): Pliny the prompter
2. [Prompt Leak](https://www.prompt.security/vulnerabilities/prompt-leak): Prompt Security
3. [chatgpt_system_prompt](https://github.com/LouisShark/chatgpt_system_prompt): LouisShark
4. [leaked-system-prompts](https://github.com/jujumilk3/leaked-system-prompts): Jujumilk3
5. [OpenAI Advanced Voice Mode System Prompt](https://x.com/Green_terminals/status/1839141326329360579): Green_Terminals

### Σχετικά Πλαίσια και Ταξινομήσεις

Ανατρέξτε σε αυτή την ενότητα για αναλυτικές πληροφορίες, στρατηγικές σεναρίων σχετικά με την ανάπτυξη υποδομών, εφαρμοσμένους ελέγχους περιβάλλοντος και άλλες βέλτιστες πρακτικές.

- [AML.T0051.000 - LLM Prompt Injection: Direct (Meta Prompt Extraction)](https://atlas.mitre.org/techniques/AML.T0051.000) **MITRE ATLAS**
