## LLM06:2025 Υπερβολική Αυτενέργεια  (Excessive Agency)

### Περιγραφή

Σε ένα σύστημα που βασίζεται σε LLM παρέχεται συχνά από τον προγραμματιστή του ένας βαθμός εξουσιοδότησης - η δυνατότητα κλήσης λειτουργιών ή διασύνδεσης με άλλα συστήματα μέσω επεκτάσεων (μερικές φορές αναφέρονται ως εργαλεία, δεξιότητες ή πρόσθετα από διάφορους προμηθευτές) για την ανάληψη ενεργειών σε απάντηση σε μια προτροπή. Η απόφαση σχετικά με το ποια επέκταση θα κληθεί μπορεί επίσης να ανατεθεί σε έναν «πράκτορα» του LLM για να καθοριστεί δυναμικά με βάση την προτροπή εισόδου ή την έξοδο του LLM. Τα συστήματα που βασίζονται σε πράκτορες συνήθως πραγματοποιούν επαναλαμβανόμενες κλήσεις σε ένα LLM χρησιμοποιώντας την έξοδο από προηγούμενες κλήσεις για να θεμελιώσουν και να κατευθύνουν τις επόμενες κλήσεις.

H υπερβολική αυτενέργεια είναι η ευπάθεια που επιτρέπει την εκτέλεση ζημιογόνων ενεργειών σε απάντηση σε απροσδόκητες, διφορούμενες ή χειραγωγημένες εξόδους από ένα LLM, ανεξάρτητα από το τι προκαλεί τη δυσλειτουργία του LLM. Οι συνήθεις αιτίες περιλαμβάνουν:

* ψευδαίσθηση/παραποίηση που προκαλείται από κακοσχεδιασμένες καλοπροαίρετες προτροπές ή απλώς από ένα μοντέλο με κακή απόδοση,
* άμεση/έμμεση έγχυση προτροπής από κακόβουλο χρήστη, προηγούμενη κλήση κακόβουλης/παραβιασμένης επέκτασης ή (σε συστήματα πολλαπλών πρακτόρων/συνεργατικών συστημάτων) από κακόβουλο/παραβιασμένο ομότιμο πράκτορα.

Η βασική αιτία της υπερβολικής αυτενέργειας είναι συνήθως ένα ή περισσότερα από τα εξής:

* υπερβολική λειτουργικότητα,
* υπερβολικά δικαιώματα,
* υπερβολική αυτονομία.

Η υπερβολική αυτενέργεια μπορεί να οδηγήσει σε ένα ευρύ πεδίο επιπτώσεων σε όλο το φάσμα της εμπιστευτικότητας, της ακεραιότητας και της διαθεσιμότητας και εξαρτάται από τα συστήματα με τα οποία μπορεί να αλληλεπιδράσει μια εφαρμογή που βασίζεται σε LLM.

Σημείωση: Η υπερβολική αυτενέργεια διαφέρει από τον επισφαλή χειρισμό των εκροών, ο οποίος αφορά τον ανεπαρκή έλεγχο των εκροών των LLM.

### Συνήθη Παραδείγματα Κινδύνων

#### 1. Υπερβολική Λειτουργικότητα

  Ένας πράκτορας LLM έχει πρόσβαση σε επεκτάσεις οι οποίες περιλαμβάνουν λειτουργίες που δεν είναι απαραίτητες για την προβλεπόμενη λειτουργία του συστήματος. Για παράδειγμα, ένας προγραμματιστής πρέπει να παραχωρήσει σε έναν πράκτορα LLM τη δυνατότητα ανάγνωσης εγγράφων από ένα αποθετήριο, αλλά η επέκταση τρίτου μέρους που επιλέγει να χρησιμοποιήσει περιλαμβάνει επίσης τη δυνατότητα τροποποίησης και διαγραφής εγγράφων.

#### 2. Υπερβολική Λειτουργικότητα

  Μια επέκταση μπορεί να δοκιμάστηκε κατά τη διάρκεια μιας φάσης ανάπτυξης και να εγκαταλείφθηκε υπέρ μιας καλύτερης εναλλακτικής λύσης, αλλά η αρχική επέκταση παραμένει διαθέσιμη στον πράκτορα LLM.

#### 3. Υπερβολική Λειτουργικότητα

  Ένα πρόσθετο LLM με ανοιχτή λειτουργικότητα δεν φιλτράρει σωστά τις οδηγίες εισόδου για εντολές που δεν είναι απαραίτητες για την προβλεπόμενη λειτουργία της εφαρμογής. Π.χ., μια επέκταση για την εκτέλεση μιας συγκεκριμένης εντολής κελύφους αποτυγχάνει να αποτρέψει σωστά την εκτέλεση άλλων εντολών κελύφους.

#### 4. Υπερβολικά Δικαιώματα

  Μια επέκταση LLM έχει δικαιώματα σε κατώτερα συστήματα που δεν είναι απαραίτητα για την προβλεπόμενη λειτουργία της εφαρμογής. Π.χ., μια επέκταση που προορίζεται να διαβάζει δεδομένα συνδέεται με έναν διακομιστή βάσης δεδομένων χρησιμοποιώντας μια ταυτότητα που έχει όχι μόνο δικαιώματα SELECT, αλλά και δικαιώματα UPDATE, INSERT και DELETE.

#### 5. Υπερβολικά Δικαιώματα

  Μια επέκταση LLM που έχει σχεδιαστεί για να εκτελεί λειτουργίες στο πλαίσιο ενός μεμονωμένου χρήστη που έχει πρόσβαση σε κατώτερα συστήματα με μια γενική ταυτότητα υψηλών προνομίων. Π.χ., μια επέκταση για την ανάγνωση της βιβλιοθήκης εγγράφων του τρέχοντος χρήστη συνδέεται στο αποθετήριο εγγράφων με έναν προνομιακό λογαριασμό που έχει πρόσβαση σε αρχεία που ανήκουν σε όλους τους χρήστες.

#### 6. Υπερβολική Αυτονομία

  Μια εφαρμογή ή επέκταση που βασίζεται σε LLM αποτυγχάνει να επαληθεύσει και να εγκρίνει ανεξάρτητα δράσεις υψηλού αντίκτυπου. Π.χ., μια επέκταση που επιτρέπει τη διαγραφή εγγράφων ενός χρήστη εκτελεί διαγραφές χωρίς καμία επιβεβαίωση από τον χρήστη.

### Στρατηγικές Πρόληψης και Αντιμετώπισης

Οι ακόλουθες ενέργειες μπορούν να αποτρέψουν την υπερβολική αυτενέργεια:

#### 1. Ελαχιστοποίηση επεκτάσεων

  Περιορίστε τις επεκτάσεις που επιτρέπεται να καλούν οι πράκτορες LLM μόνο στο απολύτως αναγκαίο. Για παράδειγμα, εάν ένα σύστημα που βασίζεται σε LLM δεν απαιτεί τη δυνατότητα να αντλεί τα περιεχόμενα μιας διεύθυνσης URL, τότε μια τέτοια επέκταση δεν θα πρέπει να προσφέρεται στον πράκτορα LLM.

#### 2. Ελαχιστοποίηση της λειτουργικότητας επέκτασης

  Περιορίστε τις λειτουργίες που υλοποιούνται στις επεκτάσεις LLM στο ελάχιστο αναγκαίο. Για παράδειγμα, μια επέκταση που έχει πρόσβαση στο γραμματοκιβώτιο ενός χρήστη για να συνοψίζει τα μηνύματα ηλεκτρονικού ταχυδρομείου μπορεί να απαιτεί μόνο τη δυνατότητα ανάγνωσης μηνυμάτων ηλεκτρονικού ταχυδρομείου, οπότε η επέκταση δεν θα πρέπει να περιέχει άλλες λειτουργίες, όπως η διαγραφή ή η αποστολή μηνυμάτων.

#### 3. Αποφύγετε επεκτάσεις ανοικτού τύπου

  Αποφύγετε τη χρήση επεκτάσεων ανοικτού τύπου όπου είναι δυνατόν (π.χ. εκτέλεση εντολής κελύφους, ανάκτηση διεύθυνσης URL κ.λπ.) και χρησιμοποιήστε επεκτάσεις με πιο λεπτομερή λειτουργικότητα. Για παράδειγμα, μια εφαρμογή που βασίζεται σε LLM μπορεί να χρειάζεται να γράψει κάποια έξοδο σε ένα αρχείο. Αν αυτό υλοποιούνταν χρησιμοποιώντας μια επέκταση για την εκτέλεση μιας λειτουργίας κελύφους, τότε το πεδίο εφαρμογής ανεπιθύμητων ενεργειών είναι πολύ μεγάλο (θα μπορούσε να εκτελεστεί οποιαδήποτε άλλη εντολή κελύφους). Μια πιο ασφαλής εναλλακτική λύση θα ήταν να δημιουργηθεί μια συγκεκριμένη επέκταση εγγραφής αρχείων που θα υλοποιεί μόνο αυτή τη συγκεκριμένη λειτουργικότητα.

#### 4. Ελαχιστοποίηση δικαιωμάτων επέκτασης

  Περιορίστε τα δικαιώματα που χορηγούνται από τις επεκτάσεις LLM σε άλλα συστήματα στο ελάχιστο αναγκαίο, προκειμένου να περιορίσετε το εύρος των ανεπιθύμητων ενεργειών. Για παράδειγμα, ένας πράκτορας LLM που χρησιμοποιεί μια βάση δεδομένων προϊόντων για να κάνει συστάσεις αγοράς σε έναν πελάτη μπορεί να χρειάζεται μόνο πρόσβαση ανάγνωσης στον πίνακα «προϊόντα»- δεν θα πρέπει να έχει πρόσβαση σε άλλους πίνακες, ούτε τη δυνατότητα εισαγωγής, ενημέρωσης ή διαγραφής εγγραφών. Αυτό θα πρέπει να επιβάλλεται με την εφαρμογή κατάλληλων δικαιωμάτων βάσης δεδομένων για το αναγνωριστικό που χρησιμοποιεί η επέκταση LLM για να συνδεθεί με τη βάση δεδομένων.

#### 5. Εκτέλεση επεκτάσεων στο πλαίσιο του χρήστη

  Παρακολούθηση της εξουσιοδότησης χρήστη και του πεδίου εφαρμογής ασφαλείας, ώστε να διασφαλίζεται ότι οι ενέργειες που πραγματοποιούνται εκ μέρους ενός χρήστη εκτελούνται στα συστήματα κατωτέρων επιπέδων στο πλαίσιο του συγκεκριμένου χρήστη και με τα ελάχιστα απαραίτητα προνόμια. Για παράδειγμα, μια επέκταση LLM που διαβάζει το αποθετήριο κώδικα ενός χρήστη θα πρέπει να απαιτεί από τον χρήστη να πιστοποιηθεί μέσω OAuth και με το ελάχιστο απαιτούμενο πεδίο εφαρμογής.

#### 6. Απαίτηση έγκρισης από τον χρήστη

  Αξιοποιήστε τον ανθρώπινο έλεγχο, ώστε να απαιτείται η έγκριση των ενεργειών υψηλού αντίκτυπου από έναν άνθρωπο πριν από τη λήψη τους. Αυτό μπορεί να υλοποιηθεί σε ένα δευτερεύον σύστημα (εκτός του πεδίου εφαρμογής του LLM) ή στην ίδια την επέκταση του LLM. Για παράδειγμα, μια εφαρμογή που βασίζεται σε LLM, η οποία δημιουργεί και δημοσιεύει περιεχόμενο στα μέσα κοινωνικής δικτύωσης για λογαριασμό ενός χρήστη, θα πρέπει να περιλαμβάνει μια ρουτίνα έγκρισης από τον χρήστη εντός της επέκτασης που υλοποιεί τη λειτουργία «δημοσίευση».

#### 7. Πλήρης διαμεσολάβηση

  Εφαρμόστε την εξουσιοδότηση στα δευτερεύοντα συστήματα αντί να βασίζεστε σε ένα LLM για να αποφασίσετε αν μια ενέργεια επιτρέπεται ή όχι. Εφαρμογή της αρχής της πλήρους διαμεσολάβησης, ώστε όλες οι αιτήσεις που υποβάλλονται σε δευτερεύοντα συστήματα μέσω επεκτάσεων να επικυρώνονται βάσει των πολιτικών ασφαλείας.

#### 8. Εξυγίανση εισόδων και εξόδων LLM

  Ακολουθήστε τις βέλτιστες πρακτικές ασφαλούς προγραμματισμού, όπως η εφαρμογή των συστάσεων του OWASP στο ASVS (Application Security Verification Standard), με ιδιαίτερη έμφαση στον καθαρισμό των εισόδων. Χρησιμοποιήστε στατικές δοκιμές ασφάλειας εφαρμογών (SAST) και δυναμικές και διαδραστικές δοκιμές εφαρμογών (DAST, IAST) στις γραμμές ανάπτυξης.

Οι ακόλουθες επιλογές δεν θα αποτρέψουν την υπερβολική αυτενέργεια, αλλά μπορούν να περιορίσουν το επίπεδο της ζημιάς που προκαλείται:

* Καταγραφή και παρακολούθηση της δραστηριότητας των επεκτάσεων LLM και των δευτερευόντων συστημάτων για τον εντοπισμό ανεπιθύμητων ενεργειών και ανάλογη αντίδραση.
* Εφαρμογή περιορισμού του ρυθμού για τη μείωση του αριθμού των ανεπιθύμητων ενεργειών που μπορούν να λάβουν χώρα σε μια δεδομένη χρονική περίοδο, αυξάνοντας την ευκαιρία ανακάλυψης ανεπιθύμητων ενεργειών μέσω της παρακολούθησης πριν από την εμφάνιση σημαντικών ζημιών.

### Παραδείγματα Σεναρίων Επίθεσης

Μια εφαρμογή προσωπικού βοηθού που βασίζεται σε LLM αποκτά πρόσβαση στο γραμματοκιβώτιο ενός χρήστη μέσω μιας επέκτασης, προκειμένου να συνοψίζει το περιεχόμενο των εισερχόμενων μηνυμάτων ηλεκτρονικού ταχυδρομείου. Για να επιτευχθεί αυτή η λειτουργικότητα, η επέκταση απαιτεί τη δυνατότητα ανάγνωσης μηνυμάτων, ωστόσο το πρόσθετο που επέλεξε να χρησιμοποιήσει ο προγραμματιστής του συστήματος περιέχει επίσης λειτουργίες για την αποστολή μηνυμάτων. Επιπλέον, η εφαρμογή είναι ευάλωτη σε μια έμμεση επίθεση έγχυσης προτροπής, κατά την οποία ένα κακόβουλα διαμορφωμένο εισερχόμενο μήνυμα ηλεκτρονικού ταχυδρομείου ξεγελά το LLM ώστε να δώσει εντολή στον πράκτορα να σαρώσει τα εισερχόμενα του χρήστη για ευαίσθητες πληροφορίες και να τις προωθήσει στη διεύθυνση ηλεκτρονικού ταχυδρομείου του επιτιθέμενου. Αυτό θα μπορούσε να αποφευχθεί με:

* εξαλείφοντας την υπερβολική λειτουργικότητα με τη χρήση μιας επέκτασης που υλοποιεί μόνο δυνατότητες ανάγνωσης αλληλογραφίας,
* εξαλείφοντας τα υπερβολικά δικαιώματα με έλεγχο ταυτότητας στην υπηρεσία ηλεκτρονικού ταχυδρομείου του χρήστη μέσω μιας συνόδου OAuth με πεδίο εφαρμογής μόνο για ανάγνωση, ή/και
* εξάλειψη της υπερβολικής αυτονομίας, απαιτώντας από τον χρήστη να ελέγχει χειροκίνητα και να πατάει το πλήκτρο «αποστολή» σε κάθε μήνυμα που συντάσσεται από την επέκταση LLM.

Εναλλακτικά, η ζημία που προκαλείται θα μπορούσε να μειωθεί με την εφαρμογή περιορισμού του ρυθμού στη διεπαφή αποστολής αλληλογραφίας.

### Σύνδεσμοι Αναφοράς

1. [Slack AI data exfil from private channels](https://promptarmor.substack.com/p/slack-ai-data-exfiltration-from-private): **PromptArmor**
2. [Rogue Agents: Stop AI From Misusing Your APIs](https://www.twilio.com/en-us/blog/rogue-ai-agents-secure-your-apis): **Twilio**
3. [Embrace the Red: Confused Deputy Problem](https://embracethered.com/blog/posts/2023/chatgpt-cross-plugin-request-forgery-and-prompt-injection./): **Embrace The Red**
4. [NeMo-Guardrails: Interface guidelines](https://github.com/NVIDIA/NeMo-Guardrails/blob/main/docs/security/guidelines.md): **NVIDIA Github**
5. [Simon Willison: Dual LLM Pattern](https://simonwillison.net/2023/Apr/25/dual-llm-pattern/): **Simon Willison**
6. [Sandboxing Agentic AI Workflows with WebAssembly](https://developer.nvidia.com/blog/sandboxing-agentic-ai-workflows-with-webassembly/) **NVIDIA, Joe Lucas**
